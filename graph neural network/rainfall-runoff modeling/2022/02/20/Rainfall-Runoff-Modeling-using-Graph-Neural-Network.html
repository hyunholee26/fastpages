<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Rainfall Runoff Modeling using Graph Neural Network | Hyunho’s Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Rainfall Runoff Modeling using Graph Neural Network" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Rainfall Runoff Modeling using Graph Neural Network" />
<meta property="og:description" content="Rainfall Runoff Modeling using Graph Neural Network" />
<link rel="canonical" href="https://hyunholee26.github.io/fastpages/graph%20neural%20network/rainfall-runoff%20modeling/2022/02/20/Rainfall-Runoff-Modeling-using-Graph-Neural-Network.html" />
<meta property="og:url" content="https://hyunholee26.github.io/fastpages/graph%20neural%20network/rainfall-runoff%20modeling/2022/02/20/Rainfall-Runoff-Modeling-using-Graph-Neural-Network.html" />
<meta property="og:site_name" content="Hyunho’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-20T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Rainfall Runoff Modeling using Graph Neural Network" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-20T00:00:00-06:00","datePublished":"2022-02-20T00:00:00-06:00","description":"Rainfall Runoff Modeling using Graph Neural Network","headline":"Rainfall Runoff Modeling using Graph Neural Network","mainEntityOfPage":{"@type":"WebPage","@id":"https://hyunholee26.github.io/fastpages/graph%20neural%20network/rainfall-runoff%20modeling/2022/02/20/Rainfall-Runoff-Modeling-using-Graph-Neural-Network.html"},"url":"https://hyunholee26.github.io/fastpages/graph%20neural%20network/rainfall-runoff%20modeling/2022/02/20/Rainfall-Runoff-Modeling-using-Graph-Neural-Network.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/fastpages/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://hyunholee26.github.io/fastpages/feed.xml" title="Hyunho's Blog" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LSS441JKCY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LSS441JKCY');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/fastpages/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/fastpages/">Hyunho&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/fastpages/about/">About Me</a><a class="page-link" href="/fastpages/search/">Search</a><a class="page-link" href="/fastpages/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Rainfall Runoff Modeling using Graph Neural Network</h1><p class="page-description">Rainfall Runoff Modeling using Graph Neural Network</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-02-20T00:00:00-06:00" itemprop="datePublished">
        Feb 20, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/fastpages/categories/#Graph Neural Network">Graph Neural Network</a>
        &nbsp;
      
        <a class="category-tags-link" href="/fastpages/categories/#Rainfall-Runoff Modeling">Rainfall-Runoff Modeling</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#1-high-resolution-rainfall-runoff-modeling-using-graph-neural-network">1. High-resolution rainfall-runoff modeling using graph neural network</a></li>
<li class="toc-entry toc-h2"><a href="#2-fully-distributedrainfall-runoff-modeling-using-spatial-temporal-graph-neural-network">2. Fully distributedrainfall-runoff modeling using spatial-temporal graph neural network</a></li>
<li class="toc-entry toc-h2"><a href="#3-large-scale-river-network-modeling-using-graph-neural-networks">3. Large-scale river network modeling using Graph Neural Networks</a></li>
</ul><h2 id="1-high-resolution-rainfall-runoff-modeling-using-graph-neural-network">
<a class="anchor" href="#1-high-resolution-rainfall-runoff-modeling-using-graph-neural-network" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. <a href="https://arxiv.org/abs/2110.10833">High-resolution rainfall-runoff modeling using graph neural network</a>
</h2>
<ul>
  <li>Authors : <a href="https://scholar.google.com/citations?hl=en&amp;user=zL50kUsAAAAJ&amp;view_op=list_works&amp;sortby=pubdate">Zhongrun Xiang</a>, <a href="https://scholar.google.com/citations?hl=en&amp;user=kPW68JcAAAAJ&amp;view_op=list_works&amp;sortby=pubdate">Ibrahim Demir</a>
</li>
  <li>Abstract : Time-series modeling has shown great promise in recent studies using the latest deep learning algorithms such as LSTM (Long Short-Term Memory). These studies primarily focused on watershed-scale rainfall-runoff modeling or streamflow forecasting, but the majority of them only considered a single watershed as a unit. Although this simplification is very effective, it does not take into account spatial information, which could result in significant errors in large watersheds. Several studies investigated the use of GNN (Graph Neural Networks) for data integration by decomposing a large watershed into multiple sub-watersheds, but each sub-watershed is still treated as a whole, and the geoinformation contained within the watershed is not fully utilized. In this paper, we propose the GNRRM (Graph Neural Rainfall-Runoff Model), a novel deep learning model that makes full use of spatial information from high-resolution precipitation data, including flow direction and geographic information. When compared to baseline models, GNRRM has less over-fitting and significantly improves model performance. Our findings support the importance of hydrological data in deep learning-based rainfall-runoff modeling, and we encourage researchers to include more domain knowledge in their models.</li>
</ul>

<h2 id="2-fully-distributedrainfall-runoff-modeling-using-spatial-temporal-graph-neural-network">
<a class="anchor" href="#2-fully-distributedrainfall-runoff-modeling-using-spatial-temporal-graph-neural-network" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. <a href="https://eartharxiv.org/repository/view/3018/">Fully distributedrainfall-runoff modeling using spatial-temporal graph neural network</a>
</h2>
<ul>
  <li>Authors : <a href="https://scholar.google.com/citations?hl=en&amp;user=zL50kUsAAAAJ&amp;view_op=list_works&amp;sortby=pubdate">Zhongrun Xiang</a>, Ibrahim Demir</li>
  <li>Abstract : Recent studies using latest deep learning algorithms such as LSTM (Long Short-Term Memory) have shown great promise in time-series modeling. There are many studies focusing on the watershed-scale rainfall-runoff modeling or streamflow forecasting, often considering a single watershed with limited generalization capabilities. To improve the model performance, several studies explored an integrated approach by decomposing a large watershed into multiple sub-watersheds with semi-distributed structure. In this study, we propose an innovative physics-informed fully-distributed rainfall-runoff model, NRM-Graph (Neural Runoff Model-Graph), using Graph Neural Networks (GNN) to make full use of spatial information including the flow direction and geographic data. Specifically, we applied a time-series model on each grid cell for its runoff production. The output of each grid cell is then aggregated by a GNN as the final runoff at the watershed outlet. The case study shows that our GNN based model successfully represents the spatial information in predictions. NRM-Graph network has shown less over-fitting and a significant improvement on the model performance compared to the baselines with spatial information. Our research further confirms the importance of spatially distributed hydrological information in rainfall-runoff modeling using deep learning, and we encourage researchers to incorporate more domain knowledge in modeling.</li>
</ul>

<h2 id="3-large-scale-river-network-modeling-using-graph-neural-networks">
<a class="anchor" href="#3-large-scale-river-network-modeling-using-graph-neural-networks" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. <a href="https://neuralhydrology.github.io/post/research/kratzert2021egu/">Large-scale river network modeling using Graph Neural Networks</a>
</h2>
<ul>
  <li>Authors : Frederik Kratzert, Daniel Klotz, Martin Gauch, Christoph Klingler, <a href="https://scholar.google.com/citations?user=nWW7D-IAAAAJ&amp;hl=en">Grey Nearing</a>, and Sepp Hochreiter</li>
  <li>Abstract : In the recent past, several studies have demonstrated the ability of deep learning (DL) models, especially based on Long Short-Term Memory (LSTM) networks, for rainfall-runoff modeling. However, almost all of these studies were limited to (multiple) individual catchments or small river networks, consisting of only a few connected catchments. In this study, we investigate large-scale, spatially distributed rainfall-runoff modeling using DL models. Our setup consists of two independent model components: One model for the runoff-generation process and one for the routing. The former is an LSTM-based model that predicts the discharge contribution of each sub-catchment in a river network. The latter is a Graph Neural Network (GNN) that routes the water along the river network network in hierarchical order. The first part is set up to simulate unimpaired runoff for every sub-catchment. Then, the GNN routes the water through the river network, incorporating human influences such as river regulations through hydropower plants. The main focus is to investigate different model architectures for the GNN that are able to learn the routing task, as well as potentially accounting for human influence. We consider models based on 1D-convolution, attention modules, as well as state-aware time series models.The decoupled approach with individual models for sub-catchment discharge prediction and routing has several benefits: a) We have an intermediate output of per-basin discharge contributions that we can inspect. b) We can leverage observed streamflow when available. That is, we can optionally substitute the discharge simulations of the first model with observed discharge, to make use of as much observed information as possible. c) We can train the model very efficiently. d) We can simulate any intermediate node in the river network, without requiring discharge observations.For the experiments, we use a new large-sample dataset called LamaH (Large-sample Data for Hydrology in Central Europe) that covers all of Austria and the foreign upstream areas of the Danube. We consider the entire Danube catchment upstream of Bratislava, a highly diverse region, including large parts of the Alps, that covers a total area of more than 130000km2. Within that area, LamaH contains hourly and daily discharge observations for more than 600 gauge stations. Thus, we investigate DL-based routing models not only for daily discharge, but also for hourly discharge.Our first results are promising, both daily and hourly discharge simulation. For example, the fully DL-based distributed models capture the dynamics as well as the timing of the devastating 2002 Danube flood. Building upon our work on learning universal, regional, and local hydrological behaviors with machine learning, we try to make the GNN-based routing as universal as possible, striving towards a globally applicable, spatially distributed, fully learned hydrological model.</li>
  <li><a href="https://presentations.copernicus.org/EGU21/EGU21-13375_presentation.pdf">ppt slide</a></li>
</ul>

  </div><a class="u-url" href="/fastpages/graph%20neural%20network/rainfall-runoff%20modeling/2022/02/20/Rainfall-Runoff-Modeling-using-Graph-Neural-Network.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/fastpages/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/fastpages/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/fastpages/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/hyunholee26" target="_blank" title="hyunholee26"><svg class="svg-icon grey"><use xlink:href="/fastpages/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
